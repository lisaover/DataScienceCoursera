---
title: "README"
author: "Lisa Over"
date: "11/5/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T,
                      results = "hide")
```

## Human Activity Recognition Using Smartphones Dataset

#### __Study Citation__

Davide Anguita, Alessandro Ghio, Luca Oneto, Xavier Parra and Jorge L. Reyes-Ortiz. Human Activity Recognition on Smartphones using a Multiclass Hardware-Friendly Support Vector Machine. International Workshop of Ambient Assisted Living (IWAAL 2012). Vitoria-Gasteiz, Spain. Dec 2012  

#### __Study Information__

The Human Activity Recognition Using Smartphones study involved 30 subjects each performing six activities (WALKING, WALKING_UPSTAIRS, WALKING_DOWNSTAIRS, SITTING, STANDING, LAYING) wearing a smartphone (Samsung Galaxy S II) on the waist. Measurements of 3-axial linear acceleration and 3-axial angular velocity were recorded from the phone's embedded accelerometer and gyroscope. The dataset was split into a training set (70%) and a testing set (30%). The study data contains files with derived or calculated data, and these files are the relevant files for this project:  

* The _UCI HAR Dataset_ folder contains the following files 

    + __features.txt__ contains a 561 element vector of features for the derived or calculated data 
    
    + __features_info.txt__ contains information about the 561 features for the derived or calculated data
    
    + __activity_labels.txt__ contains two columns to match activity identifiers with activity types  
    
* The _train_ and _test_ folders within the _UCI HAR Dataset_ folder contain the training and testing data files, respectively 

    + __X_train.txt__ and __X_test.txt__ contain the derived or calculated data  
    
    + __subject_train__ contains subject identifiers where each row corresponds to a row in the aggragated data file  
    
    + __y_train.txt__ contains activity identifiers where each row corresponds to the aggragated data file  

For more information about the study, please see the study README.txt file located in the _UCI HAR Dataset_ folder. You may also visit UCI's Machine Learning Repository: http://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones

#### Raw Data Files

The raw values for this study are located in the _Inertial Signals_ folders within the _train_ and _test_ folders. These files were not used for this project.

#### __run_analysis.R__

This R script uses the subject, labels, features, and calculated data files to create two data frames. The __mean_std_dataset__ consists of the subjectID, activityType, and features that are measures of the mean or standard deviation. The __grp_mean_std_dataset__ consists of the mean of the same variables grouped by activity type and subject id.

This script performs the following tasks:

1. Download and unzip files

2. Merge training and test sets to create one dataset

3. Extract only the measurements on the mean and standard deviation 

4. Uses descriptive activity names to name the activities in the data set

5. Confrm dataset uses descriptive variable names

6. Use descriptive activity names to name the activities in the dataset

##### 1. Download and unzip files.
```{r echo=T, results='hide'}
fileURL <- "https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip"
download.file(fileURL, destfile="./Dataset.zip")
unzip(zipfile="./Dataset.zip", exdir=".") 
```

##### 2. Merge training and test sets to create one dataset.
```{r echo=T, results='hide'}
library(dplyr)
```

###### 2.1 Read activity labels containing activity id and activity name pairs.
```{r echo=T, results='hide'}
activity_labels <- tbl_df(read.table("./UCI HAR Dataset/activity_labels.txt"))
```

###### 2.2 Read feature vector containing column names for data.
```{r echo=T, results='hide'}
features <- read.table("./UCI HAR Dataset/features.txt")
```

###### 2.3 Read training files: subjects, labels, and data.
```{r echo=T, results='hide'}
subject_train <- tbl_df(read.table("./UCI HAR Dataset/train/subject_train.txt"))
y_train <- tbl_df(read.table("./UCI HAR Dataset/train/y_train.txt"))
x_train <- tbl_df(read.table("./UCI HAR Dataset/train/X_train.txt"))
```

###### 2.4 Read testing files: subjects, labels, and data.
```{r echo=T, results='hide'}
subject_test <- tbl_df(read.table("./UCI HAR Dataset/test/subject_test.txt"))
y_test <- tbl_df(read.table("./UCI HAR Dataset/test/y_test.txt"))
x_test <- tbl_df(read.table("./UCI HAR Dataset/test/X_test.txt"))
```

###### 2.5 Assign column names.
```{r echo=T, results='hide'}
colnames(subject_test) <- "subjectID"
colnames(y_test) <- "activityID"
colnames(x_test) <- features[,2]

colnames(subject_train) <- "subjectID"
colnames(y_train) <- "activityID"
colnames(x_train) <- features[,2]

colnames(activity_labels) <- c("activityID", "activityType")
```

###### 2.6 Merge training data and add column for "train"" dataset.
```{r echo=T, results='hide'}
all_train <- bind_cols(subject_train, y_train, x_train)
all_train <- mutate(all_train, dataset = "train")
```

###### 2.7 Merge testing data and add column for "test" dataset.
```{r echo=T, results='hide'}
all_test <- bind_cols(subject_test, y_test, x_test)
all_test <- mutate(all_test, dataset = "test")
```

###### 2.8 Merge training and testing data.
```{r echo=T, results='hide'}
all_data <- bind_rows(all_train, all_test)
```

##### 3. Extract only the measurements on the mean and standard deviation.

###### 3.1 Read column names.
```{r echo=T, results='hide'}
data_columns <- colnames(all_data)
```

###### 3.2 Create a vector to define mean and standard deviation keep subjectID and activityID.
```{r echo=T, results='hide'}
ids_mean_std <- (grepl("subjectID", data_columns) | grepl("activityID", data_columns) | grepl("mean..", data_columns) | grepl("std..", data_columns))
```

###### 3.3 Use above vector to extract desired measurements from all_data.
```{r echo=T, results='hide'}
mean_std_dataset <- all_data[ , ids_mean_std == TRUE]
```

##### 4. Use descriptive activity names to name the activities in the dataset.
```{r echo=T, results='hide'}
mean_std_dataset <- left_join(mean_std_dataset, activity_labels)
mean_std_dataset <- select(mean_std_dataset, subjectID, activityType, "tBodyAcc-mean()-X":"fBodyBodyGyroJerkMag-meanFreq()")
```

##### 5. Confirm dataset uses descriptive variable names.
```{r echo=T, results='hide'}
mean_std_dataset
```

##### 6. Create a second, independent tidy data set with the average of each variable for each activity and each subject.

###### 6.1 Check for NA values.
```{r echo=T, results='hide'}
sum(is.na(mean_std_dataset))
```

###### 6.2 Group by activityType and subjectID.
```{r echo=T, results='hide'}
grp_mean_std_dataset <- mean_std_dataset %>% 
    group_by(activityType, subjectID) %>%
    summarise_all(funs(mean = mean(., na.rm = TRUE)))
```

## Codebooks

A codebook was created for each of the resulting datasets:

* codebook_mean_std_dataset.Rmd

* codebook_grp_mean_std_dataset.Rmd